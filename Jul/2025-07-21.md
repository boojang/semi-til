# ☀️SEMI TIL


- **날짜: 2025-07-21**

- 🗣️**스크럼**
  - 오늘 목표1: 새로운 cs 정리

  - 오늘 목표2: 어떻게 하면 경험과 엮어서 지식을 저장할 수 있을까?



## ❤️‍🔥 새로 배운 내용

### 1️⃣DB 커넥션 & 커넥션 풀 정리

### 1. **DB 커넥션(Connection)**

- **정의:**
  - 애플리케이션(서버)이 데이터베이스(DB)와 통신하기 위해 맺는 하나의 네트워크 연결.


- **특징:**
  - 커넥션을 생성하고 종료하는 데 리소스(시간/메모리/네트워크)가 많이 든다.

  - 매 요청마다 커넥션을 새로 만들면 성능 저하가 발생할 수 있다.


---

### 2. **커넥션 풀(Connection Pool)**

- **정의:**
  - 커넥션을 "필요할 때마다 새로 만들지 않고", 미리 여러 개를 만들어서 보관(pool)에 넣어두고, 필요할 때 빌려 쓰는 구조.


- **동작 원리:**
  - 서버 시작 시 여러 개의 커넥션을 미리 생성

  - 요청이 오면 풀에서 커넥션을 꺼내 사용

  - 사용 후 풀에 커넥션을 반납

  - 다음 요청이 오면 다시 재사용


- **장점:**
  - 커넥션 생성/종료 비용 감소

  - 여러 요청이 동시에 와도 효율적으로 처리 가능

  - 성능 향상, 리소스 낭비 최소화


---

### 3. **커넥션 풀과 DBMS의 타임아웃 설정 주의사항**

- **DBMS(예: MySQL, PostgreSQL)도 자체적으로 커넥션 유지 시간(타임아웃)을 갖고 있음**
  - 예시: MySQL의 wait_timeout (기본값 8시간 등)


- **커넥션 풀도 커넥션의 최대 생명주기를 따로 설정해야 함**
  - 예시: HikariCP의 maxLifetime, DBCP의 maxConnLifetimeMillis


### ⚠️ **문제가 되는 상황**

- DBMS의 타임아웃(예: 8시간)보다 **커넥션 풀이 더 오래 커넥션을 보관**하면
  - "죽은 커넥션(dead connection)" 에러가 발생할 수 있음


### ✅ **실무 권장 패턴**

- **커넥션 풀의 최대 유지 시간 ≤ DBMS의 커넥션 타임아웃**
  - (예: DBMS 8시간, 풀 7시간 설정)


- 풀에서 커넥션을 미리 끊고 새로 생성해줌으로써 에러를 방지

---

### 4. **설정 위치와 개념 차이**

- **커넥션 풀**
  - DBMS에 내장된 기능이 아니라,

  - 대표 예시: HikariCP, DBCP, c3p0(Java), pg-pool(Node.js), SQLAlchemy pool(Python)

  - 애플리케이션의 설정 파일(application.yml, properties 등)이나 코드에서 설정


- **DBMS(MySQL, PostgreSQL 등)**
  - 커넥션 타임아웃, 최대 연결 수 등은 **DBMS의 설정 파일(my.cnf, postgresql.conf 등)**에서 직접 설정

  - 커넥션 풀 기능 자체는 없음


---

### 💡 **비유로 이해하기**

- **커넥션 풀:**
  - 카페 앞에 미리 대기하는 바리스타 팀(=서버에서 미리 만들어둔 연결)


- **DBMS:**
  - 카페 자체(=MySQL, PostgreSQL), 바리스타를 최대 몇 명까지 받을지, 한 명이 오래 앉아 있으면 내보내는 시간 등만 설정


---

## 📝 **정리 표**





---

## 🚩 **실무 팁**

- **커넥션 풀과 DBMS의 타임아웃을 반드시 "별도"로 설정해야 한다!**

- 커넥션 풀 설정은 애플리케이션 쪽, DBMS 설정은 DB 쪽에서 직접 관리한다.


## ✏️ 오늘의 결과물

- 오늘 회고

## 🤔 오늘의 회고

- **Keep(만족했던 부분)**: 처지지 않고 행동하려고 했던 부분

- **Problem(개선이 필요한 부분): **지식을 장기 기억으로 만들고 싶다. 전문적인 답변을 하고 싶다.

- **Try(당장 행동할 수 있는 부분)**: 내가 어떻게 설명할 수 있을까?를 고민하자

## 🙏 참고 자료 및 링크

